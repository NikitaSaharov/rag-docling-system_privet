# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ RAG Docling System

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
4. [–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤](#–æ–ø–∏—Å–∞–Ω–∏–µ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
5. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—É—â–Ω–æ—Å—Ç–∏](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö-–∏-—Å—É—â–Ω–æ—Å—Ç–∏)
6. [API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã](#api-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)
7. [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ](#–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è-–ø–æ-—É—Å—Ç–∞–Ω–æ–≤–∫–µ)
8. [–†–∞–±–æ—Ç–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏](#—Ä–∞–±–æ—Ç–∞-—Å-–¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏)
9. [Telegram –±–æ—Ç](#telegram-–±–æ—Ç)
10. [–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å](#–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
11. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
12. [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)

---

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

**RAG Docling System** ‚Äî —ç—Ç–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∏—Å–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ Retrieval-Augmented Generation (RAG).

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìÑ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ PDF, DOCX, PPTX, TXT, MD
- üîç **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫**: —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ü§ñ **AI-–æ—Ç–≤–µ—Ç—ã**: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ DeepSeek LLM
- üí¨ **Telegram –±–æ—Ç**: –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ —á–µ—Ä–µ–∑ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä
- üåê **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: ChatGPT-style –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–∏—Å—Ç–µ–º–æ–π
- üë• **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º**: –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- üìä **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –Ω–∞ –¥–æ—Å—Ç—É–ø

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Backend**: Python 3.11, Flask
- **Vector Database**: Qdrant (–≤–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î)
- **Embeddings**: Ollama (nomic-embed-text, 768 dimensions)
- **LLM**: DeepSeek —á–µ—Ä–µ–∑ Polza.ai API
- **Document Processing**: Docling
- **Frontend**: Vanilla JavaScript, HTML, CSS
- **Bot**: aiogram (Telegram)
- **Infrastructure**: Docker, Docker Compose

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ          ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Web  ‚îÇ  ‚îÇTelegram ‚îÇ
‚îÇ  UI   ‚îÇ  ‚îÇ   Bot   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ          ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  Flask   ‚îÇ
    ‚îÇ  Webapp  ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                     ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Qdrant ‚îÇ         ‚îÇ  DeepSeek  ‚îÇ
‚îÇVector  ‚îÇ         ‚îÇ    LLM     ‚îÇ
‚îÇ  DB    ‚îÇ         ‚îÇ (Polza.ai) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Ollama   ‚îÇ
‚îÇ Embeddings ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–æ–ø—Ä–æ—Å —á–µ—Ä–µ–∑ Web UI –∏–ª–∏ Telegram
2. **Flask Webapp** –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
3. **Ollama** —Å–æ–∑–¥–∞—ë—Ç embedding (–≤–µ–∫—Ç–æ—Ä) –∏–∑ –≤–æ–ø—Ä–æ—Å–∞
4. **Qdrant** –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
5. **Flask** —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —á–∞–Ω–∫–æ–≤
6. **DeepSeek LLM** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
7. **–û—Ç–≤–µ—Ç** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
E:\–°–¢–û–ú–ü–†–ê–ö–¢–ò–ö–ê –ü–†–û–ï–ö–¢–´\Docling/
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker Compose
‚îú‚îÄ‚îÄ .env.local                  # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å!)
‚îú‚îÄ‚îÄ README.md                   # –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ DOCUMENTATION.md            # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
‚îÇ
‚îú‚îÄ‚îÄ webapp/                     # –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Flask
‚îÇ   ‚îú‚îÄ‚îÄ app.py                  # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ database.py             # –†–∞–±–æ—Ç–∞ —Å SQLite
‚îÇ   ‚îú‚îÄ‚îÄ admin_routes.py         # API –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt        # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ templates/
‚îÇ       ‚îú‚îÄ‚îÄ index.html          # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (—á–∞—Ç)
‚îÇ       ‚îî‚îÄ‚îÄ admin.html          # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
‚îÇ
‚îú‚îÄ‚îÄ telegram_bot/               # Telegram –±–æ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ bot.py                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ handlers.py             # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py            # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile              # Docker –æ–±—Ä–∞–∑ –±–æ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt        # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ
‚îú‚îÄ‚îÄ docling_app/                # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ process_documents.py    # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PDF/DOCX ‚Üí Markdown
‚îÇ   ‚îú‚îÄ‚îÄ create_embeddings.py    # –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ (–±—ã—Å—Ç—Ä–æ)
‚îÇ   ‚îú‚îÄ‚îÄ create_embeddings_slow.py # –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ (—Å –∑–∞–¥–µ—Ä–∂–∫–æ–π)
‚îÇ   ‚îú‚îÄ‚îÄ vectorize_all.py        # –ú–∞—Å—Å–æ–≤–∞—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ search.py               # –¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫
‚îÇ
‚îú‚îÄ‚îÄ shared/                     # –û–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ docling.db          # SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ processed/              # –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ Markdown —Ñ–∞–π–ª—ã
‚îÇ
‚îú‚îÄ‚îÄ documents/                  # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (PDF, DOCX)
‚îÇ
‚îî‚îÄ‚îÄ methodology/                # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
    ‚îî‚îÄ‚îÄ create_word_doc.py      # –°–æ–∑–¥–∞–Ω–∏–µ Word –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
```

---

## –û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 1. Flask Webapp (`webapp/`)

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–∏—Å—Ç–µ–º—ã, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π REST API –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

#### `app.py` - –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

- `get_embedding(text)` - –ø–æ–ª—É—á–µ–Ω–∏–µ embedding —á–µ—Ä–µ–∑ Ollama
- `search_documents(query, limit=15)` - –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –≤ Qdrant —Å —É–º–Ω—ã–º–∏ boosts:
  - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ñ–∞–π–ª—É "–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫" (+0.3)
  - Boost –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π (+0.5)
  - Boost –¥–ª—è —Ñ–æ—Ä–º—É–ª (+0.25)
  - Boost –¥–ª—è —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—É–ª (+0.2)
- `expand_context_around_chunks(results, window=1)` - —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–æ—Å–µ–¥–Ω–∏–º–∏ —á–∞–Ω–∫–∞–º–∏
- `ask_llm(query, context)` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ DeepSeek LLM
- `process_and_embed_document(filepath)` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:**

- `GET /` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (—á–∞—Ç)
- `GET /admin` - –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- `POST /api/search` - –ø–æ–∏—Å–∫ (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- `POST /api/telegram/check_auth` - –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `POST /api/telegram/search` - –ø–æ–∏—Å–∫ –¥–ª—è Telegram –±–æ—Ç–∞
- `POST /api/telegram/link_phone` - –ø—Ä–∏–≤—è–∑–∫–∞ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- `POST /api/upload` - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `GET /api/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- `GET /api/documents` - —Å–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è LLM:**

```python
POLZA_URL = "https://api.polza.ai/v1/chat/completions"
DEEPSEEK_MODEL = "deepseek/deepseek-chat"
MIN_SCORE_THRESHOLD = 0.40  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π score –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
```

#### `database.py` - —Ä–∞–±–æ—Ç–∞ —Å SQLite

**–¢–∞–±–ª–∏—Ü—ã:**

1. **users** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
   ```sql
   CREATE TABLE users (
       id INTEGER PRIMARY KEY AUTOINCREMENT,
       phone_number TEXT UNIQUE NOT NULL,
       telegram_id INTEGER UNIQUE,
       telegram_username TEXT,
       is_active INTEGER DEFAULT 1,
       created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
   )
   ```

2. **access_requests** - –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –¥–æ—Å—Ç—É–ø
   ```sql
   CREATE TABLE access_requests (
       id INTEGER PRIMARY KEY AUTOINCREMENT,
       phone_number TEXT NOT NULL,
       telegram_id INTEGER NOT NULL,
       telegram_username TEXT,
       status TEXT DEFAULT 'pending',
       created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
   )
   ```

3. **query_logs** - –ª–æ–≥–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
   ```sql
   CREATE TABLE query_logs (
       id INTEGER PRIMARY KEY AUTOINCREMENT,
       user_id INTEGER,
       query TEXT NOT NULL,
       response TEXT,
       created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
       FOREIGN KEY (user_id) REFERENCES users(id)
   )
   ```

**–ú–µ—Ç–æ–¥—ã:**

- `get_user_by_telegram_id(telegram_id)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ Telegram ID
- `get_user_by_phone(phone_number)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- `update_user_telegram_id(phone, telegram_id, username)` - –ø—Ä–∏–≤—è–∑–∫–∞ Telegram –∫ –Ω–æ–º–µ—Ä—É
- `create_access_request(phone, telegram_id, username)` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –¥–æ—Å—Ç—É–ø
- `get_pending_requests()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–∂–∏–¥–∞—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- `approve_access_request(request_id)` - –æ–¥–æ–±—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
- `reject_access_request(request_id)` - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
- `log_query(user_id, query, response)` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞

#### `admin_routes.py` - API –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

**–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:**

- `GET /api/admin/users` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `POST /api/admin/users` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PUT /api/admin/users/<id>` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `DELETE /api/admin/users/<id>` - —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /api/admin/access-requests` - —Å–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –¥–æ—Å—Ç—É–ø
- `POST /api/admin/access-requests` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
- `PUT /api/admin/access-requests/<id>` - –æ–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞

#### `templates/index.html` - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∞—Ç–∞

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- ChatGPT-style –¥–∏–∑–∞–π–Ω
- –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
- Inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ (1, 2, 3)
- –ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
- Markdown —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–æ—Ä–º—É–ª

**JavaScript —Ñ—É–Ω–∫—Ü–∏–∏:**

- `sendMessage()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- `parse_suggestions(text)` - –ø–∞—Ä—Å–∏–Ω–≥ —Å–µ–∫—Ü–∏–∏ "–í–æ–ø—Ä–æ—Å—ã:"
- `selectSuggestion(index)` - –≤—ã–±–æ—Ä —É—Ç–æ—á–Ω—è—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
- `toggleSources()` - –ø–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏

#### `templates/admin.html` - –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –Ω–∞ –¥–æ—Å—Ç—É–ø (–æ–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

### 2. Telegram Bot (`telegram_bot/`)

#### `bot.py` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞

```python
from aiogram import Bot, Dispatcher
from handlers import register_handlers

bot = Bot(token=TELEGRAM_BOT_TOKEN)
dp = Dispatcher()
register_handlers(dp, FLASK_API_URL)
```

#### `handlers.py` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

**–û—Å–Ω–æ–≤–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:**

1. **`cmd_start()`** - –∫–æ–º–∞–Ω–¥–∞ /start
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ `/api/telegram/check_auth`
   - –ï—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
   - –ï—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

2. **`handle_contact()`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª —Å–≤–æ–π –Ω–æ–º–µ—Ä
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ `/api/telegram/link_phone`
   - –ï—Å–ª–∏ –Ω–æ–º–µ—Ä –≤ –±–∞–∑–µ - –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç Telegram ID
   - –ï—Å–ª–∏ –Ω–µ—Ç - —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –¥–æ—Å—Ç—É–ø

3. **`handle_text_message()`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ `/api/telegram/search`
   - –ü–∞—Ä—Å–∏—Ç suggestions –∏–∑ –æ—Ç–≤–µ—Ç–∞ LLM
   - –°–æ–∑–¥–∞—ë—Ç inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏ —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –≤–æ–ø—Ä–æ—Å–æ–≤)

4. **`suggestion_callback()`** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É suggestion
   - –ò–∑–≤–ª–µ–∫–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å –∏–∑ –∫—ç—à–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –∫–∞–∫ –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

5. **`show_sources_callback()`** - –ø–æ–∫–∞–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
   - –ò–∑–≤–ª–µ–∫–∞–µ—Ç sources –∏–∑ –∫—ç—à–∞
   - –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–ø-5 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

**–§—É–Ω–∫—Ü–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞:**

```python
def parse_suggestions(text):
    """–ò–∑–≤–ª–µ–∫–∞–µ—Ç suggestions –∏–∑ —Å–µ–∫—Ü–∏–∏ '–í–æ–ø—Ä–æ—Å—ã:' –≤ –æ—Ç–≤–µ—Ç–µ LLM"""
    pattern = r'–í–æ–ø—Ä–æ—Å—ã:[\s\r]*\n((?:[\s\r]*\d+\..*?(?:\n|\r\n|$))+)'
    match = re.search(pattern, text, re.MULTILINE | re.DOTALL)
    # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç
```

#### `keyboards.py` - –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

**–§—É–Ω–∫—Ü–∏–∏:**

- `get_phone_request_keyboard()` - –∫–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞"
- `get_sources_keyboard()` - inline –∫–Ω–æ–ø–∫–∞ "üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏"
- `get_suggestions_keyboard(suggestions)` - inline –∫–Ω–æ–ø–∫–∏ 1, 2, 3 –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤

### 3. Docling App (`docling_app/`)

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π.

#### `process_documents.py` - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
docker exec docling-docling python /app/process_documents.py /documents/—Ñ–∞–π–ª.pdf
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

1. –ß–∏—Ç–∞–µ—Ç PDF/DOCX —á–µ—Ä–µ–∑ Docling
2. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ Markdown
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `/shared/processed/`

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:**

- PDF
- DOCX
- PPTX

#### `create_embeddings_slow.py` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
docker exec docling-docling python /app/create_embeddings_slow.py /shared/processed/—Ñ–∞–π–ª.md
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

1. –ß–∏—Ç–∞–µ—Ç Markdown —Ñ–∞–π–ª
2. –†–∞–∑–±–∏–≤–∞–µ—Ç –Ω–∞ —á–∞–Ω–∫–∏ (350 —Å–ª–æ–≤, overlap 70)
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞–Ω–∫–∞:
   - –°–æ–∑–¥–∞—ë—Ç embedding —á–µ—Ä–µ–∑ Ollama
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ Qdrant
   - –ó–∞–¥–µ—Ä–∂–∫–∞ 2 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (–¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —á–∞–Ω–∫–∏–Ω–≥–∞:**

```python
chunk_size = 350  # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è —Ñ–æ—Ä–º—É–ª
overlap = 70      # –ë–æ–ª—å—à–∏–π overlap –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—É–ª
```

#### `vectorize_all.py` - –º–∞—Å—Å–æ–≤–∞—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ `.md` —Ñ–∞–π–ª—ã –≤ `/shared/processed/` –∏ —Å–æ–∑–¥–∞—ë—Ç –≤–µ–∫—Ç–æ—Ä—ã.

### 4. Docker Compose (`docker-compose.yml`)

**–°–µ—Ä–≤–∏—Å—ã:**

1. **qdrant** - –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
   - –ü–æ—Ä—Ç—ã: 6333 (HTTP API), 6334 (gRPC)
   - Volume: `qdrant_data`

2. **ollama** - —Å–µ—Ä–≤–µ—Ä –¥–ª—è embeddings
   - –ü–æ—Ä—Ç: 11434
   - –ú–æ–¥–µ–ª—å: `nomic-embed-text` (768 dimensions)
   - Volume: `ollama_data`

3. **docling** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –ö–æ–º–∞–Ω–¥–∞: `tail -f /dev/null` (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ)
   - Volume: –¥–æ–∫—É–º–µ–Ω—Ç—ã, processed, shared

4. **webapp** - Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   - –ü–æ—Ä—Ç: 5000
   - –ê–≤—Ç–æ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: `pip install -r requirements.txt`
   - Volume: –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –¥–æ–∫—É–º–µ–Ω—Ç—ã

5. **telegram-bot** - Telegram –±–æ—Ç
   - Dockerfile build
   - –ó–∞–≤–∏—Å–∏—Ç –æ—Ç: webapp, qdrant

6. **n8n** - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –ü–æ—Ä—Ç: 5678
   - –õ–æ–≥–∏–Ω: admin / admin123

7. **open-webui** - UI –¥–ª—è LLM (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –ü–æ—Ä—Ç: 3000

**–°–µ—Ç—å:**

–í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏ `docling-network` (bridge).

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—É—â–Ω–æ—Å—Ç–∏

### SQLite Database (`shared/db/docling.db`)

#### –¢–∞–±–ª–∏—Ü–∞: users

| –ü–æ–ª–µ              | –¢–∏–ø       | –û–ø–∏—Å–∞–Ω–∏–µ                        |
|-------------------|-----------|---------------------------------|
| id                | INTEGER   | Primary key, –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç      |
| phone_number      | TEXT      | –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)     |
| telegram_id       | INTEGER   | Telegram ID (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)        |
| telegram_username | TEXT      | Username –≤ Telegram             |
| is_active         | INTEGER   | –ê–∫—Ç–∏–≤–µ–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (0/1)   |
| created_at        | TIMESTAMP | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è                   |

#### –¢–∞–±–ª–∏—Ü–∞: access_requests

| –ü–æ–ª–µ              | –¢–∏–ø       | –û–ø–∏—Å–∞–Ω–∏–µ                              |
|-------------------|-----------|---------------------------------------|
| id                | INTEGER   | Primary key                           |
| phone_number      | TEXT      | –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—â–µ–≥–æ         |
| telegram_id       | INTEGER   | Telegram ID                           |
| telegram_username | TEXT      | Username –≤ Telegram                   |
| status            | TEXT      | pending / approved / rejected         |
| created_at        | TIMESTAMP | –î–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞                          |

#### –¢–∞–±–ª–∏—Ü–∞: query_logs

| –ü–æ–ª–µ       | –¢–∏–ø       | –û–ø–∏—Å–∞–Ω–∏–µ                    |
|------------|-----------|-----------------------------|
| id         | INTEGER   | Primary key                 |
| user_id    | INTEGER   | Foreign key ‚Üí users.id      |
| query      | TEXT      | –¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞               |
| response   | TEXT      | –¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ LLM            |
| created_at | TIMESTAMP | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞        |

### Qdrant Collections

#### Collection: `documents_collection`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- **Vector size**: 768 (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å nomic-embed-text)
- **Distance**: Cosine

**Payload —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```json
{
  "text": "–¢–µ–∫—Å—Ç —á–∞–Ω–∫–∞ (–¥–æ 350 —Å–ª–æ–≤)",
  "filename": "–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫_–î–∏—Ä–µ–∫—Ç–æ—Ä.md",
  "chunk_index": 0,
  "total_chunks": 61
}
```

**–ü—Ä–∏–º–µ—Ä —Ç–æ—á–∫–∏:**

```json
{
  "id": "a3f2b1c...",
  "vector": [0.123, -0.456, ...],  // 768 —á–∏—Å–µ–ª
  "payload": {
    "text": "–ù–æ—Ä–º–æ—á–∞—Å –¥–æ–∫—Ç–æ—Ä–∞ (–ù–ß) = –í–í –¥–æ–∫—Ç–æ—Ä–∞ / –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤...",
    "filename": "–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫_–î–∏—Ä–µ–∫—Ç–æ—Ä.md",
    "chunk_index": 5,
    "total_chunks": 61
  }
}
```

---

## API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

#### `POST /api/search`

–ü–æ–∏—Å–∫ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º (–¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞).

**Request:**

```json
{
  "query": "–ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–æ—Ä–º–æ—á–∞—Å?",
  "history": [
    {
      "question": "–ü—Ä–µ–¥—ã–¥—É—â–∏–π –≤–æ–ø—Ä–æ—Å",
      "answer": "–ü—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Ç–≤–µ—Ç"
    }
  ]
}
```

**Response:**

```json
{
  "answer": "–ù–æ—Ä–º–æ—á–∞—Å –¥–æ–∫—Ç–æ—Ä–∞ (–ù–ß) = –í–í / t–∑–∞–≥...\n\n–í–æ–ø—Ä–æ—Å—ã:\n1. –ö–∞–∫ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏?\n2. –ö–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –≤–ª–∏—è—é—Ç –Ω–∞ –Ω–æ—Ä–º–æ—á–∞—Å?\n3. –ö–∞–∫ —É–≤–µ–ª–∏—á–∏—Ç—å –Ω–æ—Ä–º–æ—á–∞—Å?",
  "sources": [
    {
      "filename": "–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫_–î–∏—Ä–µ–∫—Ç–æ—Ä.md",
      "text": "–ù–æ—Ä–º–æ—á–∞—Å –¥–æ–∫—Ç–æ—Ä–∞ (–ù–ß)...",
      "score": 0.92
    }
  ]
}
```

#### `POST /api/upload`

–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

**Request (multipart/form-data):**

```
file: —Ñ–∞–π–ª.pdf
```

**Response:**

```json
{
  "success": true,
  "message": "–î–æ–∫—É–º–µ–Ω—Ç —Ñ–∞–π–ª.pdf —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π. –°–æ–∑–¥–∞–Ω–æ 45 —á–∞–Ω–∫–æ–≤"
}
```

#### `GET /api/stats`

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã.

**Response:**

```json
{
  "total_vectors": 61,
  "total_documents": 1
}
```

#### `GET /api/documents`

–°–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

**Response:**

```json
{
  "documents": [
    {
      "filename": "–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫_–î–∏—Ä–µ–∫—Ç–æ—Ä.md",
      "chunks": 61
    }
  ]
}
```

### Telegram Bot API

#### `POST /api/telegram/check_auth`

–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–±–µ–∑ –≤—ã–∑–æ–≤–∞ LLM).

**Request:**

```json
{
  "telegram_id": 1301040117
}
```

**Response:**

```json
{
  "authorized": true,
  "user_id": 1
}
```

#### `POST /api/telegram/search`

–ü–æ–∏—Å–∫ –¥–ª—è Telegram –±–æ—Ç–∞ (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏).

**Request:**

```json
{
  "telegram_id": 1301040117,
  "query": "–ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–æ—Ä–º–æ—á–∞—Å?",
  "history": []
}
```

**Response:**

```json
{
  "answer": "–ù–æ—Ä–º–æ—á–∞—Å –¥–æ–∫—Ç–æ—Ä–∞ (–ù–ß)...",
  "sources": [...],
  "authorized": true
}
```

–ï—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω:

```json
{
  "error": "–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.",
  "authorized": false
}
```

#### `POST /api/telegram/link_phone`

–ü—Ä–∏–≤—è–∑–∫–∞ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∫ Telegram ID.

**Request:**

```json
{
  "phone_number": "+79991234567",
  "telegram_id": 1301040117,
  "username": "user123"
}
```

**Response (–Ω–æ–º–µ—Ä –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ):**

```json
{
  "success": true,
  "message": "–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–≤—è–∑–∞–Ω",
  "user_id": 1
}
```

**Response (–Ω–æ–º–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω):**

```json
{
  "success": false,
  "error": "–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞."
}
```

### Admin API

#### `GET /api/admin/users`

–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**Response:**

```json
{
  "users": [
    {
      "id": 1,
      "phone_number": "+79991234567",
      "telegram_id": 1301040117,
      "telegram_username": "user123",
      "is_active": 1,
      "created_at": "2026-01-27 12:00:00"
    }
  ]
}
```

#### `POST /api/admin/users`

–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**Request:**

```json
{
  "phone_number": "+79991234567"
}
```

**Response:**

```json
{
  "success": true,
  "user_id": 1
}
```

#### `GET /api/admin/access-requests`

–°–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –¥–æ—Å—Ç—É–ø.

**Response:**

```json
{
  "requests": [
    {
      "id": 1,
      "phone_number": "+79991234567",
      "telegram_id": 1301040117,
      "telegram_username": "user123",
      "status": "pending",
      "created_at": "2026-01-27 12:00:00"
    }
  ]
}
```

#### `PUT /api/admin/access-requests/<id>`

–û–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞.

**Request:**

```json
{
  "action": "approve"  // –∏–ª–∏ "reject"
}
```

**Response:**

```json
{
  "success": true
}
```

---

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Docker** 20.10+
- **Docker Compose** 2.0+
- **Git**
- **RAM**: –º–∏–Ω–∏–º—É–º 8GB
- **Disk**: –º–∏–Ω–∏–º—É–º 20GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞

### –®–∞–≥ 1: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/NikitaSaharov/rag-docling-system_privet.git
cd rag-docling-system_privet
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local` –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–∞:

```bash
# .env.local
POLZA_API_KEY=your_polza_api_key_here
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
DB_PATH=/db/docling.db
FLASK_API_URL=http://webapp:5000
```

**–ì–¥–µ –≤–∑—è—Ç—å API –∫–ª—é—á–∏:**

- **Polza.ai API Key**: –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://polza.ai/dashboard
- **Telegram Bot Token**: —Å–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather)

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–ø–æ–∫

```bash
mkdir -p documents shared/processed shared/db
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

```bash
docker-compose up -d
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:**

```bash
docker-compose ps
```

–í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ `Up`:

```
NAME                  STATUS
docling-webapp        Up
docling-telegram-bot  Up
qdrant-docling        Up
ollama-docling        Up
docling-docling       Up
```

### –®–∞–≥ 5: –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ embeddings

```bash
docker exec ollama-docling ollama pull nomic-embed-text
```

### –®–∞–≥ 6: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ webapp. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
ls -la shared/db/docling.db
```

### –®–∞–≥ 7: –û—Ç–∫—Ä—ã—Ç–∏–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: **http://localhost:5000**

---

## –†–∞–±–æ—Ç–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5000
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç"**
3. –í—ã–±–µ—Ä–∏—Ç–µ PDF, DOCX –∏–ª–∏ PPTX —Ñ–∞–π–ª
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–ü—Ä–æ—Ü–µ—Å—Å:**

1. –§–∞–π–ª –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ `/documents/`
2. Docling –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ Markdown ‚Üí `/shared/processed/`
3. –°–æ–∑–¥–∞—é—Ç—Å—è —á–∞–Ω–∫–∏ (350 —Å–ª–æ–≤, overlap 70)
4. Ollama —Å–æ–∑–¥–∞—ë—Ç embeddings –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞–Ω–∫–∞
5. –í–µ–∫—Ç–æ—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Qdrant

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ CLI

#### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker cp ./my_document.pdf docling-docling:/documents/

# 2. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç (PDF ‚Üí Markdown)
docker exec docling-docling python /app/process_documents.py /documents/my_document.pdf

# 3. –°–æ–∑–¥–∞—Ç—å embeddings
docker exec docling-docling python /app/create_embeddings_slow.py /shared/processed/my_document.md
```

#### –°–ø–æ—Å–æ–± 2: –ú–∞—Å—Å–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

```bash
# –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ PDF/DOCX –≤ –ø–∞–ø–∫–µ documents/
docker exec docling-docling python /app/process_all_docx.py

# –°–æ–∑–¥–∞—Ç—å embeddings –¥–ª—è –≤—Å–µ—Ö .md —Ñ–∞–π–ª–æ–≤
docker exec docling-docling python /app/vectorize_slow_all.py
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

#### –ß–µ—Ä–µ–∑ API

```bash
curl http://localhost:5000/api/documents
```

#### –ß–µ—Ä–µ–∑ Qdrant UI

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:6333/dashboard

- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Collections** ‚Üí `documents_collection`
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ (vectors)

#### –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

- **–î–æ–∫—É–º–µ–Ω—Ç–æ–≤**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–í–µ–∫—Ç–æ—Ä–æ–≤**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞–Ω–∫–æ–≤ –≤ –±–∞–∑–µ

### –£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

```bash
# 1. –£–¥–∞–ª–∏—Ç—å –≤–µ–∫—Ç–æ—Ä—ã –∏–∑ Qdrant
curl -X POST http://localhost:6333/collections/documents_collection/points/delete \
  -H "Content-Type: application/json" \
  -d '{
    "filter": {
      "must": [
        {
          "key": "filename",
          "match": {
            "value": "my_document.md"
          }
        }
      ]
    }
  }'

# 2. –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª—ã
rm documents/my_document.pdf
rm shared/processed/my_document.md
```

### –§–æ—Ä–º–∞—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

#### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

- **PDF** (.pdf)
- **Microsoft Word** (.docx)
- **Microsoft PowerPoint** (.pptx)
- **Markdown** (.md)
- **Plain Text** (.txt)

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

1. **–î–ª—è PDF:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–µ–∫—Å—Ç –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å (–Ω–µ —Å–∫–∞–Ω-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)
   - –ò–∑–±–µ–≥–∞–π—Ç–µ —Å–ª–æ–∂–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –∏ –º–Ω–æ–≥–æ–∫–æ–ª–æ–Ω–æ—á–Ω—ã—Ö –º–∞–∫–µ—Ç–æ–≤
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ OCR –¥–ª—è –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

2. **–î–ª—è DOCX:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ç–∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
   - –§–æ—Ä–º—É–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–º –≤–∏–¥–µ
   - –ò–∑–±–µ–≥–∞–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –¥–∏–∞–≥—Ä–∞–º–º)

3. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
   - –ß—ë—Ç–∫–æ–µ –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Ä–∞–∑–¥–µ–ª—ã
   - –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π
   - –°–ø–∏—Å–∫–∏ —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π

---

## Telegram –±–æ—Ç

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞

1. **–°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞:**
   - –ù–∞–ø–∏—à–∏—Ç–µ [@BotFather](https://t.me/BotFather)
   - –ö–æ–º–∞–Ω–¥–∞ `/newbot`
   - –í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ username
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω

2. **–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ `.env.local`:**

```bash
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
```

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç:**

```bash
docker-compose restart telegram-bot
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞

#### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. **–°—Ç–∞—Ä—Ç:** `/start`
2. **–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞** —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É
3. **–î–æ–∂–¥–∏—Ç–µ—Å—å –æ–¥–æ–±—Ä–µ–Ω–∏—è** –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
4. **–ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã** –∫–∞–∫ –≤ –æ–±—ã—á–Ω–æ–º —á–∞—Ç–µ

#### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:** http://localhost:5000/admin
2. **–†–∞–∑–¥–µ–ª "–ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –¥–æ—Å—Ç—É–ø"**
3. **–ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. **–ù–∞–∂–º–∏—Ç–µ "–û–¥–æ–±—Ä–∏—Ç—å"**

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ —Å–º–æ–∂–µ—Ç –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã.

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É / –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
- `/help` - —Å–ø—Ä–∞–≤–∫–∞
- `/clear` - –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞

### –§—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞

1. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞:**
   - –ë–æ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –Ω–æ–º–µ—Ä —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –∫–Ω–æ–ø–∫—É Telegram
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –Ω–æ–º–µ—Ä–∞ –≤ –±–∞–∑–µ
   - –ï—Å–ª–∏ –µ—Å—Ç—å - –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç Telegram ID
   - –ï—Å–ª–∏ –Ω–µ—Ç - —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –¥–æ—Å—Ç—É–ø

2. **–ü–æ–∏—Å–∫ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º:**
   - –ë–æ—Ç –ø–æ–º–Ω–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –≤–æ–ø—Ä–æ—Å–æ–≤-–æ—Ç–≤–µ—Ç–æ–≤
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Ö –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞

3. **Inline –∫–Ω–æ–ø–∫–∏:**
   - –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø–æ—è–≤–ª—è—é—Ç—Å—è –∫–Ω–æ–ø–∫–∏ 1, 2, 3
   - –ö–ª–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å
   - –ö–Ω–æ–ø–∫–∞ "üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

4. **Suggestions (—É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã):**
   - LLM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 2-3 —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–∞
   - –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –≤–∏–¥–µ –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
   - –ö–Ω–æ–ø–∫–∏ 1, 2, 3 –ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã–±–æ—Ä–∞

### –õ–æ–≥–∏ –±–æ—Ç–∞

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f telegram-bot

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
docker-compose logs --tail=100 telegram-bot
```

---

## –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (http://localhost:5000)

#### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∞—Ç–∞

- **–ü–æ–ª–µ –≤–≤–æ–¥–∞** –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞
- **–ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞** –≤ —Ü–µ–Ω—Ç—Ä–µ
- **–ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏"** –ø–æ–¥ –∫–∞–∂–¥—ã–º –æ—Ç–≤–µ—Ç–æ–º
- **–ö–Ω–æ–ø–∫–∏ 1, 2, 3** –¥–ª—è —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤

#### –ö–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞

–í –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É - –∫–Ω–æ–ø–∫–∞ **"üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç"**

**–ü—Ä–æ—Ü–µ—Å—Å:**

1. –ö–ª–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫—É
2. –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞ (PDF, DOCX, PPTX)
3. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 1-3 –º–∏–Ω—É—Ç—ã)
4. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ

### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (http://localhost:5000/admin)

#### –†–∞–∑–¥–µ–ª "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏"

- **–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ Telegram ID
- **–ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è":**
  - –í–≤–æ–¥ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
  - –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–∑ Telegram ID
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–≤—è–∂–µ—Ç Telegram –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –≤ –±–æ—Ç–∞

#### –†–∞–∑–¥–µ–ª "–ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –¥–æ—Å—Ç—É–ø"

- **–°–ø–∏—Å–æ–∫ –æ–∂–∏–¥–∞—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**
- **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:**
  - –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
  - Telegram ID
  - Telegram username
  - –î–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞
- **–î–µ–π—Å—Ç–≤–∏—è:**
  - –ö–Ω–æ–ø–∫–∞ "–û–¥–æ–±—Ä–∏—Ç—å" - —Å–æ–∑–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç Telegram
  - –ö–Ω–æ–ø–∫–∞ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å" - —É–¥–∞–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å

#### –†–∞–∑–¥–µ–ª "–õ–æ–≥–∏ –∑–∞–ø—Ä–æ—Å–æ–≤"

(–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
- –§–∏–ª—å—Ç—Ä –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env.local`)

```bash
# Polza.ai API (–¥–ª—è DeepSeek LLM)
POLZA_API_KEY=ak_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Telegram Bot
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz

# Database
DB_PATH=/db/docling.db

# Flask API URL (–¥–ª—è Telegram –±–æ—Ç–∞)
FLASK_API_URL=http://webapp:5000
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ LLM (–≤ `webapp/app.py`)

```python
# API endpoint
POLZA_URL = "https://api.polza.ai/v1/chat/completions"

# –ú–æ–¥–µ–ª—å
DEEPSEEK_MODEL = "deepseek/deepseek-chat"

# –ü–æ—Ä–æ–≥ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
MIN_SCORE_THRESHOLD = 0.40  # –æ—Ç 0.0 –¥–æ 1.0

# –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (–∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤)
temperature = 0.0  # 0.0 = —Ç–æ—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, 1.0 = –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞
max_tokens = 2000
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∏—Å–∫–∞

```python
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–∑ Qdrant
limit = 50  # –£–≤–µ–ª–∏—á–µ–Ω–æ –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ö–≤–∞—Ç–∞

# –û–∫–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (—Å–æ—Å–µ–¥–Ω–∏–µ —á–∞–Ω–∫–∏)
window = 1  # ¬±1 —á–∞–Ω–∫ –≤–æ–∫—Ä—É–≥ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ

# Boost –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
SPRAVOCHNIK_BOOST = 0.3   # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫—É
DEFINITION_BOOST = 0.5    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º
FORMULA_BOOST = 0.25      # –§–æ—Ä–º—É–ª–∞–º
VAR_BOOST = 0.2           # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–º —Ñ–æ—Ä–º—É–ª
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–∞–Ω–∫–∏–Ω–≥–∞

```python
# –†–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ (–≤ —Å–ª–æ–≤–∞—Ö)
chunk_size = 350

# Overlap (–ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –º–µ–∂–¥—É —á–∞–Ω–∫–∞–º–∏)
overlap = 70
```

---

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

```bash
docker-compose ps
docker-compose logs <service_name>
```

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down
docker-compose up -d --build

# –û—á–∏—Å—Ç–∏—Ç—å volumes (–í–ù–ò–ú–ê–ù–ò–ï: —É–¥–∞–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ!)
docker-compose down -v
docker-compose up -d
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

```bash
docker-compose logs -f telegram-bot
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**

1. **–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TELEGRAM_BOT_TOKEN` –≤ `.env.local`
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather

2. **Webapp –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `docker-compose logs webapp`
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ webapp –∑–∞–ø—É—â–µ–Ω: `docker-compose ps webapp`

3. **Timeout –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤—É—é —Å–≤—è–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ: `docker-compose restart telegram-bot webapp`

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ "–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É"

**–ü—Ä–∏—á–∏–Ω–∞:** Webapp –Ω–µ —É—Å–ø–µ–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å –∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã.

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ webapp:
   ```bash
   docker-compose logs -f webapp
   ```

2. –£–≤–µ–ª–∏—á—å—Ç–µ timeout –≤ `telegram_bot/handlers.py`:
   ```python
   timeout=aiohttp.ClientTimeout(total=10)  # –±—ã–ª–æ 3
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –Ω–∞—Ö–æ–¥–∏—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ–∫—Ç–æ—Ä–æ–≤ –≤ Qdrant
curl http://localhost:6333/collections/documents_collection

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Markdown —Ñ–∞–π–ª—ã
ls -la shared/processed/
```

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ embeddings:
   ```bash
   docker exec docling-docling python /app/vectorize_slow_all.py
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–æ–¥–µ–ª—å embeddings:
   ```bash
   docker exec ollama-docling ollama list
   ```

3. –ï—Å–ª–∏ –º–æ–¥–µ–ª–∏ –Ω–µ—Ç:
   ```bash
   docker exec ollama-docling ollama pull nomic-embed-text
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–Ω–æ–ø–∫–∏ suggestions –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** LLM –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–µ–∫—Ü–∏—é "–í–æ–ø—Ä–æ—Å—ã:" –∏–ª–∏ regex –Ω–µ –ø–∞—Ä—Å–∏—Ç.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

```bash
docker-compose logs -f telegram-bot | grep "–ü–∞—Ä—Å–∏–Ω–≥ suggestions"
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**

```
–ü–∞—Ä—Å–∏–Ω–≥ suggestions: –Ω–∞–π–¥–µ–Ω–æ 3 –≤–æ–ø—Ä–æ—Å–æ–≤
  1. –ö–∞–∫ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏?
  2. –ö–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –≤–ª–∏—è—é—Ç –Ω–∞ –Ω–æ—Ä–º–æ—á–∞—Å?
  3. –ö–∞–∫ —É–≤–µ–ª–∏—á–∏—Ç—å –Ω–æ—Ä–º–æ—á–∞—Å?
```

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 500 —Å–∏–º–≤–æ–ª–æ–≤ –æ—Ç–≤–µ—Ç–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –æ—Ç–≤–µ—Ç–µ –µ—Å—Ç—å —Å–µ–∫—Ü–∏—è "–í–æ–ø—Ä–æ—Å—ã:"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ regex –≤ `parse_suggestions()`

### –ü—Ä–æ–±–ª–µ–º–∞: LLM –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É 402

**–ü—Ä–∏—á–∏–Ω–∞:** –ó–∞–∫–æ–Ω—á–∏–ª—Å—è –±–∞–ª–∞–Ω—Å Polza.ai

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ https://polza.ai/dashboard
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á –≤ `.env.local`

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

```bash
ls -la shared/db/docling.db
```

**–†–µ—à–µ–Ω–∏–µ:**

1. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –≤—Ä—É—á–Ω—É—é:
   ```bash
   mkdir -p shared/db
   chmod 777 shared/db
   ```

2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ webapp:
   ```bash
   docker-compose restart webapp
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   docker-compose logs webapp | grep "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö"
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: Qdrant –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

```bash
docker-compose logs qdrant
```

**–†–µ—à–µ–Ω–∏–µ:**

1. –û—á–∏—Å—Ç–∏—Ç–µ volume:
   ```bash
   docker-compose down
   docker volume rm docling_qdrant_data
   docker-compose up -d qdrant
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç—ã (6333, 6334 –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–Ω–∞—Ç—ã):
   ```bash
   netstat -an | grep 6333
   ```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### Docker

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f <service_name>

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
docker-compose restart <service_name>

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã
docker-compose down

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ + —É–¥–∞–ª–µ–Ω–∏–µ volumes
docker-compose down -v

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose up -d --build <service_name>

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker exec <container_name> <command>

# –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker exec -it <container_name> bash
```

### –†–∞–±–æ—Ç–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

```bash
# –û–±—Ä–∞–±–æ—Ç–∞—Ç—å PDF
docker exec docling-docling python /app/process_documents.py /documents/file.pdf

# –°–æ–∑–¥–∞—Ç—å embeddings
docker exec docling-docling python /app/create_embeddings_slow.py /shared/processed/file.md

# –ú–∞—Å—Å–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
docker exec docling-docling python /app/vectorize_slow_all.py

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ Qdrant
curl http://localhost:6333/collections/documents_collection
```

### –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

```bash
# –í–æ–π—Ç–∏ –≤ SQLite
docker exec -it docling-webapp sqlite3 /db/docling.db

# –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
.tables

# –í—ã–±—Ä–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
SELECT * FROM users;

# –í—ã–±—Ä–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã
SELECT * FROM access_requests WHERE status='pending';

# –í—ã—Ö–æ–¥
.quit
```

### Ollama

```bash
# –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π
docker exec ollama-docling ollama list

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å
docker exec ollama-docling ollama pull nomic-embed-text

# –£–¥–∞–ª–∏—Ç—å –º–æ–¥–µ–ª—å
docker exec ollama-docling ollama rm nomic-embed-text

# –¢–µ—Å—Ç embedding
curl http://localhost:11434/api/embeddings -d '{
  "model": "nomic-embed-text",
  "prompt": "test text"
}'
```

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

- **GitHub**: https://github.com/NikitaSaharov/rag-docling-system_privet
- **Email**: support@example.com

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 1.0  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 01.02.2026  
**–ê–≤—Ç–æ—Ä:** RAG Docling System Team
